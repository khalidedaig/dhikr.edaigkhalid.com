import{l as y}from"./LearningService-Czx3c3rm.js";import{d as C,r as m,o as A,c as n,a as l,b as t,e as x,t as i,f as S,F as p,g as f,h as k,i as $,u as j,j as E,w as M,n as P}from"./app-D3EUv0vf.js";import{_ as B}from"./Layout.vue_vue_type_script_setup_true_lang-GzgPcik0.js";import"./UserInfo.vue_vue_type_script_setup_true_lang-zyzFVlRi.js";import"./RovingFocusGroup-kDH8phwG.js";import"./useForwardExpose-BP1Fj1cu.js";import"./createLucideIcon-DYCzr9ix.js";import"./sun-Bneiykno.js";import"./user-CQlBhAWg.js";import"./log-out-B0DWKVyH.js";const G={key:0,class:"shimport { learningService, type PersonalizedInsights, type GoalSuggestion } from '@/Services/LearningService'; import { onMounted, ref } from 'vue';ow-lg mb-8 rounded-lg bg-white p-6 dark:bg-gray-800"},Y={key:0,class:"mb-4 rounded-lg bg-blue-50 p-4 dark:bg-blue-900"},V={class:"flex items-center"},F={class:"mr-3 text-2xl font-bold text-blue-600 dark:text-blue-400"},q={key:1,class:"mb-4 rounded-lg bg-green-50 p-4 dark:bg-green-900"},H={class:"text-sm text-green-700 dark:text-green-300"},J={class:"font-medium text-green-600 dark:text-green-400"},K={key:2,class:"mb-4 rounded-lg bg-purple-50 p-4 dark:bg-purple-900"},U={class:"space-y-2"},W={class:"text-sm text-purple-600 dark:text-purple-400"},Q={class:"text-xs font-medium text-purple-500 dark:text-purple-300"},R={key:3,class:"mb-4 rounded-lg bg-orange-50 p-4 dark:bg-orange-900"},X={class:"grid grid-cols-2 gap-4"},Z={class:"text-center"},tt={class:"text-lg font-bold text-orange-600 dark:text-orange-400"},et={class:"text-center"},st={class:"text-lg font-bold text-orange-600 dark:text-orange-400"},at={key:4,class:"mb-4 rounded-lg bg-yellow-50 p-4 dark:bg-yellow-900"},rt={class:"space-y-1"},ot={key:5,class:"rounded-lg bg-indigo-50 p-4 dark:bg-indigo-900"},nt={class:"space-y-2"},lt={class:"font-medium"},it={key:1,class:"mb-8 rounded-lg border-2 border-dashed border-gray-300 p-6 text-center dark:border-gray-600"},dt=C({__name:"LearningInsights",props:{dhikrList:{default:()=>[{id:1,transliteration:"Subhan Allah"},{id:2,transliteration:"Alhamdulillah"},{id:3,transliteration:"Allahu Akbar"},{id:4,transliteration:"La ilaha illa Allah"},{id:5,transliteration:"Astaghfirullah"},{id:6,transliteration:"Bismillah"},{id:7,transliteration:"La hawla wa la quwwata illa billah"},{id:8,transliteration:"Hasbi Allahu wa ni'mal wakeel"}]},currentDhikrId:{}},setup(I){const g=I,a=m({consistency:0,bestTime:"",improvement:[],streakInfo:{current:0,longest:0},favoritesDhikr:[],goalOptimization:[]}),v=m(!1),_=m(null),D=()=>{try{a.value=y.getPersonalizedInsights();const c=y.getSessions();v.value=c.length>=3,g.currentDhikrId&&(_.value=y.getSuggestedGoal(g.currentDhikrId.toString()))}catch(c){console.error("Error loading insights:",c),v.value=!1}},h=c=>{const s=g.dhikrList.find(o=>o.id==c);return s?s.transliteration:`Dhikr ${c}`};return A(()=>{D()}),(c,s)=>v.value?(l(),n("div",G,[s[10]||(s[10]=t("h2",{class:"mb-4 text-xl font-semibold text-gray-900 dark:text-white"},"🧠 Learning Insights",-1)),a.value.consistency!==void 0?(l(),n("div",Y,[s[1]||(s[1]=t("h4",{class:"mb-2 font-medium text-blue-800 dark:text-blue-200"},"📈 Consistency Score",-1)),t("div",V,[t("div",F,i(a.value.consistency)+"%",1),s[0]||(s[0]=t("div",{class:"text-sm text-blue-700 dark:text-blue-300"},"of the last 7 days",-1))])])):x("",!0),a.value.bestTime&&a.value.bestTime!=="Not enough data"?(l(),n("div",q,[s[3]||(s[3]=t("h4",{class:"mb-2 font-medium text-green-800 dark:text-green-200"},"⏰ Best Performance Time",-1)),t("p",H,[s[2]||(s[2]=S(" You complete dhikr most successfully during ")),t("span",J,i(a.value.bestTime),1)])])):x("",!0),a.value.favoritesDhikr&&a.value.favoritesDhikr.length>0?(l(),n("div",K,[s[4]||(s[4]=t("h4",{class:"mb-3 font-medium text-purple-800 dark:text-purple-200"},"💝 Most Practiced",-1)),t("div",U,[(l(!0),n(p,null,f(a.value.favoritesDhikr.slice(0,3),o=>(l(),n("div",{key:o.dhikrId,class:"flex items-center justify-between"},[t("span",W,i(h(o.dhikrId)),1),t("span",Q,i(o.count)+" sessions",1)]))),128))])])):x("",!0),a.value.streakInfo?(l(),n("div",R,[s[7]||(s[7]=t("h4",{class:"mb-2 font-medium text-orange-800 dark:text-orange-200"},"🔥 Streak Information",-1)),t("div",X,[t("div",Z,[t("div",tt,i(a.value.streakInfo.current),1),s[5]||(s[5]=t("div",{class:"text-xs text-orange-700 dark:text-orange-300"},"Current Streak",-1))]),t("div",et,[t("div",st,i(a.value.streakInfo.longest),1),s[6]||(s[6]=t("div",{class:"text-xs text-orange-700 dark:text-orange-300"},"Longest Streak",-1))])])])):x("",!0),a.value.improvement&&a.value.improvement.length>0?(l(),n("div",at,[s[8]||(s[8]=t("h4",{class:"mb-3 font-medium text-yellow-800 dark:text-yellow-200"},"💡 Suggestions",-1)),t("ul",rt,[(l(!0),n(p,null,f(a.value.improvement,o=>(l(),n("li",{key:o,class:"text-sm text-yellow-700 dark:text-yellow-300"}," • "+i(o),1))),128))])])):x("",!0),a.value.goalOptimization&&a.value.goalOptimization.length>0?(l(),n("div",ot,[s[9]||(s[9]=t("h4",{class:"mb-3 font-medium text-indigo-800 dark:text-indigo-200"},"🎯 Goal Optimization",-1)),t("div",nt,[(l(!0),n(p,null,f(a.value.goalOptimization.slice(0,2),o=>(l(),n("div",{key:o.dhikrId,class:"text-sm text-indigo-700 dark:text-indigo-300"},[t("span",lt,i(h(o.dhikrId))+":",1),S(" "+i(o.tip),1)]))),128))])])):x("",!0)])):(l(),n("div",it,s[11]||(s[11]=[t("div",{class:"text-gray-500 dark:text-gray-400"},[t("p",{class:"mb-2"},"🌱 Start practicing to see your learning insights!"),t("p",{class:"text-sm"},"Complete a few dhikr sessions to unlock personalized recommendations.")],-1)])))}}),ut={class:"mx-auto max-w-6xl"},gt={class:"mb-8 grid gap-6 md:grid-cols-3"},ct={class:"rounded-lg bg-white p-6 shadow-lg dark:bg-gray-800"},mt={class:"text-center"},xt={class:"mb-2 text-3xl font-bold text-blue-600 dark:text-blue-400"},ht={class:"rounded-lg bg-white p-6 shadow-lg dark:bg-gray-800"},kt={class:"text-center"},yt={class:"mb-2 text-3xl font-bold text-green-600 dark:text-green-400"},pt={class:"rounded-lg bg-white p-6 shadow-lg dark:bg-gray-800"},vt={class:"text-center"},bt={class:"mb-2 text-3xl font-bold text-purple-600 dark:text-purple-400"},ft={class:"mb-8 rounded-lg bg-white p-6 shadow-lg dark:bg-gray-800"},_t={class:"grid grid-cols-7 gap-2"},wt={class:"mb-2 text-xs text-gray-500 dark:text-gray-400"},St={class:"flex h-24 items-end justify-center rounded-lg bg-gray-200 p-1 dark:bg-gray-700"},Dt={class:"mt-1 text-xs font-medium text-gray-700 dark:text-gray-300"},$t={class:"mb-8 rounded-lg bg-white p-6 shadow-lg dark:bg-gray-800"},It={class:"space-y-3"},Ct={class:"font-medium text-gray-700 dark:text-gray-300"},At={class:"text-lg font-bold text-blue-600 dark:text-blue-400"},Tt={key:0,class:"py-8 text-center text-gray-500 dark:text-gray-400"},zt={class:"rounded-lg bg-gradient-to-r from-blue-50 to-purple-50 p-6 dark:from-blue-900 dark:to-purple-900"},Ot={class:"grid gap-4 md:grid-cols-2"},Lt={class:"rounded-lg bg-white p-4 dark:bg-gray-800"},Nt={class:"text-sm text-gray-600 dark:text-gray-300"},jt={class:"rounded-lg bg-white p-4 dark:bg-gray-800"},Et={class:"text-sm text-gray-600 dark:text-gray-300"},Kt=C({__name:"Analytics",setup(I){const g=m({}),a=m({totalSessions:0,totalCounts:0,averageSessionDuration:0,streakDays:0,consistency:0,favoriteTime:"",recentSessions:[]}),v=m({consistency:0,bestTime:"",improvement:[],streakInfo:{current:0,longest:0},favoritesDhikr:[],goalOptimization:[]}),_=m(!1),D=m([]),h=k(()=>{const r=new Date().toISOString().split("T")[0],e=g.value[r]||{sessions:0,totalCount:0,dhikrTypes:{}};return{sessions:e.sessions||0,totalCount:e.totalCount||0,dhikrTypes:e.dhikrTypes||{}}}),c=k(()=>{const r=[],e=new Date;for(let d=6;d>=0;d--){const u=new Date(e);u.setDate(u.getDate()-d);const b=u.toISOString().split("T")[0],w=g.value[b]||{totalCount:0};r.push({label:u.toLocaleDateString("en-US",{weekday:"short"}),count:w.totalCount,percentage:Math.min(w.totalCount/500*100,100)})}return r}),s=k(()=>{const r=c.value.reduce((e,d)=>e+d.count,0);return Math.round(r/7)}),o=k(()=>{var d;if(a.value&&typeof a.value=="object"&&"streakDays"in a.value)return a.value.streakDays;let r=0;const e=new Date;for(let u=0;u<365;u++){const b=new Date(e);b.setDate(b.getDate()-u);const w=b.toISOString().split("T")[0];if(((d=g.value[w])==null?void 0:d.totalCount)>0)r++;else break}return r}),T=k(()=>Math.max(...Object.values(g.value).map(r=>r.totalCount),0)),z=k(()=>{let r=0,e="";return Object.entries(g.value).forEach(([d,u])=>{u.totalCount>r&&(r=u.totalCount,e=d)}),e?new Date(e).toLocaleDateString():"N/A"}),O=()=>{const r=localStorage.getItem("dhikr_analytics");r&&(g.value=JSON.parse(r));try{a.value=y.getAnalyticsSummary(),v.value=y.getPersonalizedInsights(),D.value=a.value.recentSessions||[];const e=y.getSessions();_.value=e.length>=3}catch(e){console.error("Error loading analytics:",e),_.value=!1}},L=r=>({default:"General Tasbih",dhikr_1:"Subhan Allah",dhikr_2:"Alhamdulillah",dhikr_3:"Allahu Akbar",dhikr_4:"La ilaha illa Allah",dhikr_5:"Astaghfirullah"})[r]||r,N=()=>o.value>=7?`Excellent! You've maintained a ${o.value}-day streak. Keep up the amazing work!`:o.value>=3?`Good consistency with a ${o.value}-day streak. Try to reach a week!`:o.value>=1?`You're building a habit! Current streak: ${o.value} day(s).`:"Start building your dhikr habit today!";return A(()=>{O()}),(r,e)=>(l(),n(p,null,[$(j(E),{title:"Analytics"}),$(B,null,{default:M(()=>[t("div",ut,[e[9]||(e[9]=t("h1",{class:"mb-8 text-center text-3xl font-bold text-gray-900 dark:text-white"},"📊 Your Dhikr Analytics",-1)),t("div",gt,[t("div",ct,[t("div",mt,[t("div",xt,i(h.value.totalCount),1),e[0]||(e[0]=t("p",{class:"text-gray-600 dark:text-gray-300"},"Today's Total",-1))])]),t("div",ht,[t("div",kt,[t("div",yt,i(o.value),1),e[1]||(e[1]=t("p",{class:"text-gray-600 dark:text-gray-300"},"Day Streak",-1))])]),t("div",pt,[t("div",vt,[t("div",bt,i(s.value),1),e[2]||(e[2]=t("p",{class:"text-gray-600 dark:text-gray-300"},"Weekly Average",-1))])])]),t("div",ft,[e[3]||(e[3]=t("h2",{class:"mb-4 text-xl font-semibold text-gray-900 dark:text-white"},"Past 7 Days",-1)),t("div",_t,[(l(!0),n(p,null,f(c.value,(d,u)=>(l(),n("div",{key:u,class:"text-center"},[t("div",wt,i(d.label),1),t("div",St,[t("div",{class:"w-full rounded bg-blue-500",style:P({height:`${d.percentage}%`})},null,4)]),t("div",Dt,i(d.count),1)]))),128))])]),t("div",$t,[e[4]||(e[4]=t("h2",{class:"mb-4 text-xl font-semibold text-gray-900 dark:text-white"},"Dhikr Types Today",-1)),t("div",It,[(l(!0),n(p,null,f(h.value.dhikrTypes,(d,u)=>(l(),n("div",{key:u,class:"flex items-center justify-between rounded-lg bg-gray-50 p-3 dark:bg-gray-700"},[t("span",Ct,i(L(u)),1),t("span",At,i(d),1)]))),128))]),Object.keys(h.value.dhikrTypes).length===0?(l(),n("div",Tt," No dhikr recorded today. Start your spiritual practice! ")):x("",!0)]),$(dt),t("div",zt,[e[8]||(e[8]=t("h2",{class:"mb-4 text-xl font-semibold text-gray-900 dark:text-white"},"🎯 Insights & Suggestions",-1)),t("div",Ot,[t("div",Lt,[e[6]||(e[6]=t("h3",{class:"mb-2 font-medium text-gray-900 dark:text-white"},"Best Performance",-1)),t("p",Nt,[e[5]||(e[5]=S(" Your highest count was ")),t("strong",null,i(T.value),1),S(" on "+i(z.value)+". ",1)])]),t("div",jt,[e[7]||(e[7]=t("h3",{class:"mb-2 font-medium text-gray-900 dark:text-white"},"Consistency",-1)),t("p",Et,i(N()),1)])])])])]),_:1})],64))}});export{Kt as default};
