import{d as D,r as b,h,k as y,o as A,c as g,a as v,e as p,b as o,t as i,n as V,l as N,v as O}from"./app-D3EUv0vf.js";import{l as m}from"./LearningService-Czx3c3rm.js";const R={class:"rounded-lg bg-white p-6 text-center shadow-lg dark:bg-gray-800"},B={key:0,class:"mb-6"},M={class:"arabic-text mb-2 text-3xl font-bold text-green-600 dark:text-green-400"},F={class:"mb-1 text-lg text-gray-600 dark:text-gray-300"},J={class:"text-sm text-gray-500 dark:text-gray-400"},$={class:"mb-6"},q={class:"mb-2 text-6xl font-bold text-blue-600 dark:text-blue-400"},z={key:0,class:"mb-4"},E={class:"mb-2 text-lg text-gray-600 dark:text-gray-300"},K={class:"h-3 w-full rounded-full bg-gray-200 dark:bg-gray-700"},P={class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},U={class:"mb-6"},W={class:"flex flex-col space-y-4"},j=["disabled"],H={key:1,class:"mt-4 rounded-lg border border-green-300 bg-green-100 p-3 dark:border-green-700 dark:bg-green-900"},X=D({__name:"Counter",props:{dhikr:{},initialCount:{default:0},initialGoal:{default:100},counterId:{default:"default"}},setup(_){const n=_,r=b(n.initialCount),l=b(n.initialGoal),k=b(Date.now()),s=h(()=>l.value),x=h(()=>s.value<=0?0:Math.min(r.value/s.value*100,100)),S=h(()=>s.value>0&&r.value>=s.value),d=e=>`dhikr_${n.counterId}_${e}`,c=()=>{localStorage.setItem(d("count"),r.value.toString()),localStorage.setItem(d("goal"),l.value.toString());const e=JSON.parse(localStorage.getItem("dhikr_analytics")||"{}"),t=new Date().toISOString().split("T")[0];e[t]||(e[t]={sessions:0,totalCount:0,dhikrTypes:{}}),e[t].totalCount=r.value,e[t].dhikrTypes[n.counterId]=r.value,localStorage.setItem("dhikr_analytics",JSON.stringify(e))},I=()=>{const e=localStorage.getItem(d("count")),t=localStorage.getItem(d("goal"));e&&(r.value=parseInt(e)),t&&(l.value=parseInt(t))},w=()=>{var t,a;if(s.value>0&&r.value>=s.value)return;r.value++;const e=((a=(t=n.dhikr)==null?void 0:t.id)==null?void 0:a.toString())||n.counterId;m.recordInteraction("increment",e),s.value>0&&r.value>=s.value&&f(),c(),"vibrate"in navigator&&navigator.vibrate(50),G()},C=()=>{var e,t;if(confirm("Are you sure you want to reset the counter?")){r.value>0&&f(),r.value=0,k.value=Date.now();const a=((t=(e=n.dhikr)==null?void 0:e.id)==null?void 0:t.toString())||n.counterId;m.recordInteraction("reset",a),c()}},T=()=>{var a,u;const e=((u=(a=n.dhikr)==null?void 0:a.id)==null?void 0:u.toString())||n.counterId,t=parseInt(localStorage.getItem(d("goal"))||"0");m.recordInteraction("goal_change",e,{newGoal:l.value,oldGoal:t}),c()},f=()=>{var a,u;const e=((u=(a=n.dhikr)==null?void 0:a.id)==null?void 0:u.toString())||n.counterId,t=Date.now();m.recordSession(e,r.value,s.value,k.value,t),k.value=Date.now()},G=()=>{try{const e=new(window.AudioContext||window.webkitAudioContext),t=e.createOscillator(),a=e.createGain();t.connect(a),a.connect(e.destination),t.frequency.setValueAtTime(800,e.currentTime),a.gain.setValueAtTime(.1,e.currentTime),a.gain.exponentialRampToValueAtTime(.01,e.currentTime+.1),t.start(e.currentTime),t.stop(e.currentTime+.1)}catch{}};return y(r,c),y(l,c),A(()=>{var e;I(),(e=n.dhikr)!=null&&e.defaultGoal&&l.value===n.initialGoal&&(l.value=n.dhikr.defaultGoal)}),(e,t)=>(v(),g("div",R,[e.dhikr?(v(),g("div",B,[o("h2",M,i(e.dhikr.arabic),1),o("p",F,i(e.dhikr.transliteration),1),o("p",J,i(e.dhikr.meaning),1)])):p("",!0),o("div",$,[o("div",q,i(r.value),1),s.value>0?(v(),g("div",z,[o("div",E,i(r.value)+" / "+i(s.value),1),o("div",K,[o("div",{class:"progress-bar h-3 rounded-full bg-green-500",style:V({width:x.value+"%"})},null,4)]),o("div",P,i(x.value.toFixed(1))+"% Complete",1)])):p("",!0)]),o("div",U,[t[1]||(t[1]=o("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"}," Set Goal ",-1)),N(o("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>l.value=a),type:"number",min:"1",max:"10000",class:"w-24 rounded-md border border-gray-300 bg-white px-3 py-2 text-center text-gray-900 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100",onChange:T},null,544),[[O,l.value,void 0,{number:!0}]])]),o("div",W,[o("button",{onClick:w,class:"counter-animation cursor-pointer rounded-lg bg-green-500 px-8 py-4 text-xl font-bold text-white transition-colors duration-200 hover:bg-green-600 focus:ring-4 focus:ring-green-300 focus:outline-none dark:bg-green-600 dark:hover:bg-green-700 dark:focus:ring-green-800",disabled:s.value>0&&r.value>=s.value},t[2]||(t[2]=[o("span",{class:"text-2xl"},"+",-1),o("span",{class:"mt-1 block text-sm"},"Tap to Count",-1)]),8,j),o("button",{onClick:C,class:"cursor-pointer rounded-lg bg-red-500 px-4 py-2 font-medium text-white transition-colors duration-200 hover:bg-red-600 focus:ring-4 focus:ring-red-300 focus:outline-none dark:bg-red-600 dark:hover:bg-red-700 dark:focus:ring-red-800"}," Reset ")]),S.value?(v(),g("div",H,t[3]||(t[3]=[o("p",{class:"font-medium text-green-800 dark:text-green-200"},"ðŸŽ‰ Goal Reached! Well done!",-1)]))):p("",!0)]))}});export{X as _};
